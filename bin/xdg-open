#!/usr/bin/rc
# Shamelessly stolen from Drew DeVault
# https://git.sr.ht/~sircmpwn/dotfiles/tree/master/item/bin/xdg-open

targ=$1
scheme=`{echo $targ | cut -d: -f1}

fn bymime(mt) {
	switch ($mt) {
		case application/pdf
			exec $BROWSER $targ
		case image/svg+xml
			exec $BROWSER $targ
		case image/*
			exec $VIEWER $targ
		case *openxml*
			exec $OFFICE $targ
		default {
			echo "Don't know how to open $targ"
			exit 1
		}
	}
}

switch ($scheme) {
	case http
		exec $BROWSER $targ
	case https
		exec $BROWSER $targ
	case mailto
		exec $MAIL $targ
	default {
		bymime `{file --mime-type $targ | cut -d' ' -f2}
	}
}
